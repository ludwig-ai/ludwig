


<!doctype html>
<html lang="en" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">

      <meta name="description" content="Deep learning toolbox">


      <link rel="canonical"
            href="https://uber.github.io/ludwig/api/LudwigModel/">


      <meta content="Piero Molino" name="author">

      <link rel="shortcut icon" href="../../favicon.ico">
      <meta content="mkdocs-1.1, mkdocs-material-5.1.3" name="generator">


      <title>LudwigModel - Ludwig</title>


      <link href="../../assets/stylesheets/main.62d34fff.min.css"
            rel="stylesheet">

      <link href="../../assets/stylesheets/palette.c8acc6db.min.css"
            rel="stylesheet">


      <meta content="#757575" name="theme-color">


      <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
      <link rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
      <style>body, input {
          font-family: "Roboto", -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif
      }

      code, kbd, pre {
          font-family: "Roboto Mono", SFMono-Regular, Consolas, Menlo, monospace
      }</style>


      <link rel="stylesheet" href="../../stylesheets/extra.css">

      <link rel="stylesheet" href="../../stylesheets/monokai.css">


  </head>


  <body data-md-color-accent="grey" data-md-color-primary="grey" dir="ltr">

  <input autocomplete="off" class="md-toggle" data-md-toggle="drawer"
         id="__drawer" type="checkbox">
  <input autocomplete="off" class="md-toggle" data-md-toggle="search"
         id="__search" type="checkbox">
  <label class="md-overlay" for="__drawer"></label>
  <div data-md-component="skip">


      <a class="md-skip" href="#ludwigmodel-class">
          Skip to content
      </a>

  </div>
  <div data-md-component="announce">

  </div>

  <header class="md-header" data-md-component="header">
      <nav aria-label="Header" class="md-header-nav md-grid">
          <a aria-label="Ludwig" class="md-header-nav__button md-logo"
             href="https://uber.github.io/ludwig/" title="Ludwig">

              <img alt="logo" src="../../images/ludwig_logo.svg"
                   style="height:1rem;width:4rem;">

          </a>
          <label class="md-header-nav__button md-icon" for="__drawer">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/>
              </svg>
          </label>
          <div class="md-header-nav__title" data-md-component="header-title">

              <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Ludwig
          </span>
                  <span class="md-header-nav__topic md-ellipsis">
            
              LudwigModel
            
          </span>
              </div>

          </div>

          <label class="md-header-nav__button md-icon" for="__search">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
              </svg>
          </label>

          <div class="md-search" data-md-component="search" role="dialog">
              <label class="md-search__overlay" for="__search"></label>
              <div class="md-search__inner" role="search">
                  <form class="md-search__form" name="search">
                      <input aria-label="Search" autocapitalize="off"
                             autocomplete="off" autocorrect="off"
                             class="md-search__input"
                             data-md-component="search-query"
                             data-md-state="active" name="query"
                             placeholder="Search" spellcheck="false"
                             type="text">
                      <label class="md-search__icon md-icon" for="__search">
                          <svg viewBox="0 0 24 24"
                               xmlns="http://www.w3.org/2000/svg">
                              <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                          </svg>
                          <svg viewBox="0 0 24 24"
                               xmlns="http://www.w3.org/2000/svg">
                              <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                          </svg>
                      </label>
                      <button aria-label="Clear" class="md-search__icon md-icon"
                              data-md-component="search-reset" tabindex="-1"
                              type="reset">
                          <svg viewBox="0 0 24 24"
                               xmlns="http://www.w3.org/2000/svg">
                              <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                          </svg>
                      </button>
                  </form>
                  <div class="md-search__output">
                      <div class="md-search__scrollwrap" data-md-scrollfix>
                          <div class="md-search-result"
                               data-md-component="search-result">
                              <div class="md-search-result__meta">
                                  Initializing search
                              </div>
                              <ol class="md-search-result__list"></ol>
                          </div>
                      </div>
                  </div>
              </div>
          </div>


          <div class="md-header-nav__source">

              <a class="md-source" href="https://github.com/uber/ludwig/"
                 title="Go to repository">
                  <div class="md-source__icon md-icon">

                      <svg viewBox="0 0 448 512"
                           xmlns="http://www.w3.org/2000/svg">
                          <path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/>
                      </svg>
                  </div>
                  <div class="md-source__repository">
                      uber/ludwig
                  </div>
              </a>
          </div>

      </nav>
  </header>

  <div class="md-container" data-md-component="container">


      <main class="md-main" data-md-component="main">
          <div class="md-main__inner md-grid">


              <div class="md-sidebar md-sidebar--primary"
                   data-md-component="navigation">
                  <div class="md-sidebar__scrollwrap">
                      <div class="md-sidebar__inner">
                          <nav aria-label="Navigation"
                               class="md-nav md-nav--primary"
                               data-md-level="0">
                              <label class="md-nav__title" for="__drawer">
                                  <a aria-label="Ludwig"
                                     class="md-nav__button md-logo"
                                     href="https://uber.github.io/ludwig/"
                                     title="Ludwig">
                                      <img alt="logo"
                                           src="../../images/ludwig_logo.svg"
                                           style="width:10rem;height:auto;">
                                  </a>
                              </label>

                              <div class="md-nav__source">

                                  <a class="md-source"
                                     href="https://github.com/uber/ludwig/"
                                     title="Go to repository">
                                      <div class="md-source__icon md-icon">

                                          <svg viewBox="0 0 448 512"
                                               xmlns="http://www.w3.org/2000/svg">
                                              <path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/>
                                          </svg>
                                      </div>
                                      <div class="md-source__repository">
                                          uber/ludwig
                                      </div>
                                  </a>
                              </div>

                              <ul class="md-nav__list" data-md-scrollfix>


                                  <li class="md-nav__item">
                                      <a href="../.." title="About"
                                         class="md-nav__link">
      About
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../../getting_started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../../user_guide/" title="User Guide" class="md-nav__link">
      User Guide
    </a>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../../developer_guide/" title="Developer Guide" class="md-nav__link">
      Developer Guide
    </a>
  </li>


                                  <li class="md-nav__item md-nav__item--active md-nav__item--nested">

                                      <input checked
                                             class="md-nav__toggle md-toggle"
                                             data-md-toggle="nav-6" id="nav-6"
                                             type="checkbox">

                                      <label class="md-nav__link" for="nav-6">
                                          API
                                          <span class="md-nav__icon md-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path
                d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/></svg>
      </span>
                                      </label>
                                      <nav aria-label="API" class="md-nav"
                                           data-md-level="1">
                                          <label class="md-nav__title"
                                                 for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path
                  d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/></svg>
        </span>
                                              API
                                          </label>
                                          <ul class="md-nav__list"
                                              data-md-scrollfix>


                                              <li class="md-nav__item md-nav__item--active">

                                                  <input class="md-nav__toggle md-toggle"
                                                         data-md-toggle="toc"
                                                         id="__toc"
                                                         type="checkbox">


                                                  <label class="md-nav__link md-nav__link--active"
                                                         for="__toc">
                                                      LudwigModel
                                                      <span class="md-nav__icon md-icon">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path
                  d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z"/></svg>
        </span>
                                                  </label>

                                                  <a class="md-nav__link md-nav__link--active"
                                                     href="./"
                                                     title="LudwigModel">
                                                      LudwigModel
                                                  </a>


                                                  <nav aria-label="Table of contents"
                                                       class="md-nav md-nav--secondary">


                                                      <label class="md-nav__title"
                                                             for="__toc">
      <span class="md-nav__icon md-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path
                d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/></svg>
      </span>
                                                          Table of contents
                                                      </label>
                                                      <ul class="md-nav__list"
                                                          data-md-scrollfix>

                                                          <li class="md-nav__item">
                                                              <a class="md-nav__link"
                                                                 href="#ludwigmodel-class">
                                                                  LudwigModel
                                                                  class
                                                              </a>

                                                          </li>

                                                          <li class="md-nav__item">
                                                              <a class="md-nav__link"
                                                                 href="#ludwigmodel-methods">
                                                                  LudwigModel
                                                                  methods
                                                              </a>

                                                              <nav aria-label="LudwigModel methods"
                                                                   class="md-nav">
                                                                  <ul class="md-nav__list">

                                                                      <li class="md-nav__item">
                                                                          <a class="md-nav__link"
                                                                             href="#close">
                                                                              close
                                                                          </a>

                                                                      </li>

                                                                      <li class="md-nav__item">
                                                                          <a class="md-nav__link"
                                                                             href="#initialize_model">
                                                                              initialize_model
                                                                          </a>

                                                                      </li>

                                                                      <li class="md-nav__item">
                                                                          <a class="md-nav__link"
                                                                             href="#load">
                                                                              load
                                                                          </a>

                                                                      </li>

                                                                      <li class="md-nav__item">
                                                                          <a href="#predict"
                                                                             class="md-nav__link">
                                                                              predict
                                                                          </a>

                                                                      </li>

                                                                      <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_for_serving" class="md-nav__link">
    save_for_serving
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_logging_level" class="md-nav__link">
    set_logging_level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    train
  </a>
  
</li>
        
          <li class="md-nav__item">
              <a href="#train_online" class="md-nav__link">
                  train_online
              </a>

          </li>

                                                                  </ul>
                                                              </nav>

                                                          </li>

                                                          <li class="md-nav__item">
                                                              <a class="md-nav__link"
                                                                 href="#module-functions">
                                                                  Module
                                                                  functions
                                                              </a>

                                                              <nav aria-label="Module functions"
                                                                   class="md-nav">
                                                                  <ul class="md-nav__list">

                                                                      <li class="md-nav__item">
                                                                          <a class="md-nav__link"
                                                                             href="#kfold_cross_validate">
                                                                              kfold_cross_validate
                                                                          </a>

                                                                      </li>

                                                                  </ul>
                                                              </nav>

                                                          </li>

                                                      </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
    </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                  <div class="md-sidebar__scrollwrap">
                      <div class="md-sidebar__inner">

                          <nav aria-label="Table of contents"
                               class="md-nav md-nav--secondary">


                              <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path
                d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/></svg>
      </span>
                                  Table of contents
                              </label>
                              <ul class="md-nav__list" data-md-scrollfix>

                                  <li class="md-nav__item">
                                      <a class="md-nav__link"
                                         href="#ludwigmodel-class">
                                          LudwigModel class
                                      </a>

                                  </li>

                                  <li class="md-nav__item">
                                      <a class="md-nav__link"
                                         href="#ludwigmodel-methods">
                                          LudwigModel methods
                                      </a>

                                      <nav aria-label="LudwigModel methods"
                                           class="md-nav">
                                          <ul class="md-nav__list">

                                              <li class="md-nav__item">
                                                  <a class="md-nav__link"
                                                     href="#close">
                                                      close
                                                  </a>

                                              </li>

                                              <li class="md-nav__item">
                                                  <a class="md-nav__link"
                                                     href="#initialize_model">
                                                      initialize_model
                                                  </a>

                                              </li>

                                              <li class="md-nav__item">
                                                  <a class="md-nav__link"
                                                     href="#load">
                                                      load
                                                  </a>

                                              </li>

                                              <li class="md-nav__item">
                                                  <a href="#predict"
                                                     class="md-nav__link">
                                                      predict
                                                  </a>

                                              </li>

                                              <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    save
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_for_serving" class="md-nav__link">
    save_for_serving
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_logging_level" class="md-nav__link">
    set_logging_level
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    train
  </a>
  
</li>
        
          <li class="md-nav__item">
              <a href="#train_online" class="md-nav__link">
                  train_online
              </a>

          </li>

                                          </ul>
                                      </nav>

                                  </li>

                                  <li class="md-nav__item">
                                      <a class="md-nav__link"
                                         href="#module-functions">
                                          Module functions
                                      </a>

                                      <nav aria-label="Module functions"
                                           class="md-nav">
                                          <ul class="md-nav__list">

                                              <li class="md-nav__item">
                                                  <a class="md-nav__link"
                                                     href="#kfold_cross_validate">
                                                      kfold_cross_validate
                                                  </a>

                                              </li>

                                          </ul>
                                      </nav>

                                  </li>

                              </ul>

                          </nav>
                      </div>
                  </div>
              </div>


              <div class="md-content">
                  <article class="md-content__inner md-typeset">


                      <a class="md-content__button md-icon"
                         href="https://github.com/uber/ludwig/edit/master/mkdocs/docs/api/LudwigModel.md"
                         title="Edit this page">
                          <svg viewBox="0 0 24 24"
                               xmlns="http://www.w3.org/2000/svg">
                              <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                          </svg>
                      </a>


                      <h1>LudwigModel</h1>

                      <p><span style="float:right;"><a
                              href="https://github.com/uber/ludwig/blob/master/ludwig/api.py#L69">[source]</a></span>
                      </p>
                      <h2 id="ludwigmodel-class">LudwigModel class<a
                              class="headerlink" href="#ludwigmodel-class"
                              title="Permanent link">&para;</a></h2>
                      <div class="codehilite"><pre><span></span><code><span
                              class="n">ludwig</span><span
                              class="o">.</span><span class="n">api</span><span
                              class="o">.</span><span
                              class="n">LudwigModel</span><span
                              class="p">(</span>
  <span class="n">model_definition</span><span class="o">=</span><span
                                  class="kc">None</span><span class="p">,</span>
  <span class="n">model_definition_file</span><span class="o">=</span><span
                                  class="kc">None</span><span class="p">,</span>
  <span class="n">logging_level</span><span class="o">=</span><span class="mi">40</span>
<span class="p">)</span>
</code></pre>
                      </div>


                      <p>Class that allows access to high level Ludwig
                          functionalities.</p>
                      <p><strong>Inputs</strong></p>
                      <ul>
                          <li><strong>model_definition</strong> (dict): a
                              dictionary containing information needed
                              to build a model. Refer to the [User Guide]
                              (http://ludwig.ai/user_guide/#model-definition)
                              for details.
                          </li>
                          <li><strong>model_definition_file</strong> (string,
                              optional, default: <code>None</code>): path to
                              a YAML file containing the model definition. If
                              available it will be
                              used instead of the model_definition dict.
                          </li>
                          <li><strong>logging_level</strong> (int, default:
                              <code>logging.ERROR</code>): logging level to use
                              for logging. Use logging constants like <code>logging.DEBUG</code>,
                              <code>logging.INFO</code> and
                              <code>logging.ERROR</code>. By default only errors
                              will be
                              printed. It is possible to change the
                              logging_level later by using
                              the set_logging_level method.
                          </li>
                      </ul>
<p><strong>Example usage:</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">ludwig.api</span> <span class="kn">import</span> <span class="n">LudwigModel</span>
</code></pre></div>


<p>Train a model:</p>
<div class="codehilite"><pre><span></span><code><span class="n">model_definition</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
<span class="n">ludwig_model</span> <span class="o">=</span> <span class="n">LudwigModel</span><span class="p">(</span><span class="n">model_definition</span><span class="p">)</span>
<span class="n">train_stats</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data_csv</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">)</span>
</code></pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span><code><span class="n">train_stats</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">data_df</span><span class="o">=</span><span class="n">dataframe</span><span class="p">)</span>
</code></pre></div>


<p>If you have already trained a model you can load it and use it to predict</p>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig_model</span> <span class="o">=</span> <span class="n">LudwigModel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</code></pre></div>


<p>Predict:</p>
<div class="codehilite"><pre><span></span><code><span class="n">predictions</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_csv</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">)</span>
</code></pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span><code><span class="n">predictions</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_df</span><span class="o">=</span><span class="n">dataframe</span><span class="p">)</span>
</code></pre></div>


<p>Test:</p>
<div class="codehilite"><pre><span></span><code><span class="n">predictions</span><span class="p">,</span> <span class="n">test_stats</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">data_csv</span><span class="o">=</span><span class="n">csv_file_path</span><span class="p">)</span>
</code></pre></div>


<p>or</p>
<div class="codehilite"><pre><span></span><code><span class="n">predictions</span><span class="p">,</span> <span class="n">test_stats</span> <span class="o">=</span> <span class="n">ludwig_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_df</span><span class="o">=</span><span class="n">dataframe</span><span class="p">)</span>
</code></pre></div>


<p>Finally in order to release resources:</p>
<div class="codehilite"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>


<hr />
<h2 id="ludwigmodel-methods">LudwigModel methods<a class="headerlink" href="#ludwigmodel-methods" title="Permanent link">&para;</a></h2>
<h3 id="close">close<a class="headerlink" href="#close" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">close</span><span class="p">(</span>
<span class="p">)</span>
</code></pre></div>


<p>Closes an open LudwigModel (closing the session running it).
It should be called once done with the model to release resources.</p>
<hr />
<h3 id="initialize_model">initialize_model<a class="headerlink" href="#initialize_model" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">initialize_model</span><span class="p">(</span>
  <span class="n">train_set_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">train_set_metadata_json</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpu_fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
  <span class="n">debug</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<p>This function initializes a model. It is need for performing online
learning, so it has to be called before <code>train_online</code>.
<code>train</code> initialize the model under the hood, so there is no need to call
this function if you don't use <code>train_online</code>.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>train_set_metadata</strong> (dict): it contains metadata information for
   the input and output features the model is going to be trained
   on. It's the same content of the metadata json file that is
   created while training.</li>
<li><strong>train_set_metadata_json</strong> (string):  path to the JSON metadata file
   created while training. it contains metadata information for the
   input and output features the model is going to be trained on</li>
<li><strong>gpus</strong> (string, default: <code>None</code>): list of GPUs to use (it uses the
   same syntax of CUDA_VISIBLE_DEVICES)</li>
<li><strong>gpu_fraction</strong> (float, default <code>1.0</code>): fraction of GPU memory to
   initialize the process with</li>
<li><strong>random_seed</strong> (int, default<code>42</code>): a random seed that is going to be
   used anywhere there is a call to a random number generator: data
   splitting, parameter initialization and training set shuffling</li>
<li><strong>debug</strong> (bool, default: <code>False</code>): enables debugging mode</li>
</ul>
<hr />
<h3 id="load">load<a class="headerlink" href="#load" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">load</span><span class="p">(</span>
  <span class="n">model_dir</span>
<span class="p">)</span>
</code></pre></div>


<p>This function allows for loading pretrained models</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>model_dir</strong> (string): path to the directory containing the model.
   If the model was trained by the <code>train</code> or <code>experiment</code> command,
   the model is in <code>results_dir/experiment_dir/model</code>.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>return</strong> (LudwigModel): a LudwigModel object</li>
</ul>
<p><strong>Example usage</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig_model</span> <span class="o">=</span> <span class="n">LudwigModel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</code></pre></div>


<hr />
<h3 id="predict">predict<a class="headerlink" href="#predict" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
  <span class="n">data_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">return_type</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;,</span>
  <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
  <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpu_fraction</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">skip_save_unprocessed_output</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>


<p>This function is used to predict the output variables given the input
variables using the trained model.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>data_df</strong> (DataFrame): dataframe containing data. Only the input
   features defined in the model definition need to be present in
   the dataframe.</li>
<li><strong>data_csv</strong> (string): input data CSV file. Only the input features
   defined in the model definition need to be present in the CSV.</li>
<li><strong>data_dict</strong> (dict): input data dictionary. It is expected to
   contain one key for each field and the values have to be lists
   of the same length. Each index in the lists corresponds to one
   datapoint. Only the input features defined in the model
   definition need to be present in the dataframe. For example a
   data set consisting of two datapoints with a input text may be
   provided as the following dict <code>`{'text_field_name}: ['text of
   the first datapoint', text of the second datapoint']}</code>.</li>
<li><strong>return_type</strong> (strng or type, default: <code>DataFrame</code>):
   string describing the type of the returned prediction object.
   <code>'dataframe'</code>, <code>'df'</code> and <code>DataFrame</code> will return a pandas
   DataFrame , while <code>'dict'</code>, ''dictionary'<code>and</code>dict` will
   return a dictionary.</li>
<li><strong>batch_size</strong> (int, default: <code>128</code>): batch size</li>
<li><strong>skip_save_unprocessed_output</strong> (skip_save_unprocessed_output: If this parameter is False):skip_save_unprocessed_output: If this parameter is False,
   predictions and their probabilities are saved in both raw
   unprocessed numpy files contaning tensors and as postprocessed
   CSV files (one for each output feature). If this parameter is
   True, only the CSV ones are saved and the numpy ones are skipped.</li>
<li><strong>gpus</strong> (string, default: <code>None</code>): list of GPUs to use (it uses the
   same syntax of CUDA_VISIBLE_DEVICES)</li>
<li><strong>gpu_fraction</strong> (float, default <code>1.0</code>): fraction of gpu memory to
   initialize the process with</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>return</strong> (DataFrame or dict): a dataframe containing the predictions for
     each output feature and their probabilities (for types that
     return them) will be returned. For instance in a 3 way
     multiclass classification problem with a category field names
     <code>class</code> as output feature with possible values <code>one</code>, <code>two</code>
     and <code>three</code>, the dataframe will have as many rows as input
     datapoints and five columns: <code>class_predictions</code>,
     <code>class_UNK_probability</code>, <code>class_one_probability</code>,
     <code>class_two_probability</code>, <code>class_three_probability</code>. (The UNK
     class is always present in categorical features).
     If the <code>return_type</code> is a dictionary, the returned object be
     a dictionary contaning one entry for each output feature.
     Each entry is itself a dictionary containing aligned
     arrays of predictions and probabilities / scores.</li>
</ul>
<hr />
<h3 id="save">save<a class="headerlink" href="#save" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">save</span><span class="p">(</span>
  <span class="n">save_path</span>
<span class="p">)</span>
</code></pre></div>


<p>This function allows to save models on disk</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong> save_path</strong> (string): path to the directory where the model is
    going to be saved. Both a JSON file containing the model
    architecture hyperparameters and checkpoints files containing
    model weights will be saved.</li>
</ul>
<p><strong>Example usage</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div>


<hr />
<h3 id="save_for_serving">save_for_serving<a class="headerlink" href="#save_for_serving" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">save_for_serving</span><span class="p">(</span>
  <span class="n">save_path</span>
<span class="p">)</span>
</code></pre></div>


<p>This function allows to save models on disk</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong> save_path</strong> (string): path to the directory where the SavedModel
    is going to be saved.</li>
</ul>
<p><strong>Example usage</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig_model</span><span class="o">.</span><span class="n">save_for_serving</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
</code></pre></div>


<hr />
<h3 id="set_logging_level">set_logging_level<a class="headerlink" href="#set_logging_level" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">set_logging_level</span><span class="p">(</span>
  <span class="n">logging_level</span>
<span class="p">)</span>
</code></pre></div>


<p>:param logging_level: Set/Update the logging level. Use logging
constants like <code>logging.DEBUG</code> , <code>logging.INFO</code> and <code>logging.ERROR</code>.</p>
<p>:return: None</p>
<hr />
<h3 id="test">test<a class="headerlink" href="#test" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
  <span class="n">data_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">return_type</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;,</span>
  <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
  <span class="n">skip_save_unprocessed_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpu_fraction</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>


<p>This function is used to predict the output variables given the input
variables using the trained model and compute test statistics like
performance measures, confusion matrices and the like.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>data_df</strong> (DataFrame): dataframe containing data. Both input and
   output features defined in the model definition need to be
   present in the dataframe.</li>
<li><strong>data_csv</strong> (string): input data CSV file. Both input and output
   features defined in the model definition need to be present in
   the CSV.</li>
<li><strong>data_dict</strong> (dict): input data dictionary. It is expected to
   contain one key for each field and the values have to be lists
   of the same length. Each index in the lists corresponds to one
   datapoint. Both input and output features defined in the model
   definition need to be present in the dataframe. For example a
   data set consisting of two datapoints with a input text may be
   provided as the following dict <code>`{'text_field_name}: ['text of
   the first datapoint', text of the second datapoint']}</code>.</li>
<li><strong>return_type</strong> (strng or type, default: <code>DataFrame</code>):
   string describing the type of the returned prediction object.
   <code>'dataframe'</code>, <code>'df'</code> and <code>DataFrame</code> will return a pandas
   DataFrame , while <code>'dict'</code>, ''dictionary'<code>and</code>dict` will
   return a dictionary.</li>
<li><strong>batch_size</strong> (int, default: <code>128</code>): batch size</li>
<li><strong>skip_save_unprocessed_output</strong> (skip_save_unprocessed_output: If this parameter is False):skip_save_unprocessed_output: If this parameter is False,
   predictions and their probabilities are saved in both raw
   unprocessed numpy files contaning tensors and as postprocessed
   CSV files (one for each output feature). If this parameter is
   True, only the CSV ones are saved and the numpy ones are skipped.</li>
<li><strong>gpus</strong> (string, default: <code>None</code>): list of GPUs to use (it uses the
   same syntax of CUDA_VISIBLE_DEVICES)</li>
<li><strong>gpu_fraction</strong> (float, default <code>1.0</code>): fraction of GPU memory to
   initialize the process with</li>
</ul>
<p><strong>Return</strong></p>
<ul>
<li><strong>return</strong> (tuple((DataFrame or dict), dict)): a tuple of a dataframe and a
     dictionary. The dataframe contains the predictions for each
     output feature and their probabilities (for types that return
     them) will be returned. For instance in a 3 way multiclass
     classification problem with a category field names <code>class</code> as
     output feature with possible values <code>one</code>, <code>two</code> and <code>three</code>,
     the dataframe will have as many rows as input datapoints and
     five columns: <code>class_predictions</code>, <code>class_UNK_probability</code>,
     <code>class_one_probability</code>, <code>class_two_probability</code>,
     <code>class_three_probability</code>. (The UNK class is always present in
     categorical features).
     If the <code>return_type</code> is a dictionary, the first object
     of the tuple will be a dictionary contaning one entry
     for each output feature.
     Each entry is itself a dictionary containing aligned
     arrays of predictions and probabilities / scores.
     The second object of the tuple is a dictionary that contains
     the test statistics, with each key being the name of an output
     feature and the values being dictionaries containing measures
     names and their values.</li>
</ul>
<hr />
<h3 id="train">train<a class="headerlink" href="#train" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">train</span><span class="p">(</span>
  <span class="n">data_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_train_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_validation_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_test_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_train_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_validation_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_test_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_hdf5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_train_hdf5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_validation_hdf5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_test_hdf5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_train_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_validation_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_test_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">train_set_metadata_json</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">experiment_name</span><span class="o">=</span><span class="s1">&#39;api_experiment&#39;</span><span class="p">,</span>
  <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;run&#39;</span><span class="p">,</span>
  <span class="n">model_load_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">model_resume_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">skip_save_training_description</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">skip_save_training_statistics</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">skip_save_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">skip_save_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">skip_save_log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">skip_save_processed_input</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">output_directory</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">,</span>
  <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpu_fraction</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
  <span class="n">use_horovod</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
  <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
  <span class="n">debug</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>


<p>This function is used to perform a full training of the model on the
specified dataset.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>data_df</strong> (DataFrame): dataframe containing data. If it has a split
   column, it will be used for splitting (0: train, 1: validation,
   2: test), otherwise the dataset will be randomly split</li>
<li><strong>data_train_df</strong> (DataFrame): dataframe containing training data</li>
<li><strong>data_validation_df</strong> (DataFrame): dataframe containing validation
   data</li>
<li><strong>data_test_df</strong> (DataFrame dataframe containing test dat):data_test_df: (DataFrame dataframe containing test data</li>
<li><strong>data_csv</strong> (string): input data CSV file. If it has a split column,
   it will be used for splitting (0: train, 1: validation, 2: test),
   otherwise the dataset will be randomly split</li>
<li><strong>data_train_csv</strong> (string): input train data CSV file</li>
<li><strong>data_validation_csv</strong> (string): input validation data CSV file</li>
<li><strong>data_test_csv</strong> (string): input test data CSV file</li>
<li><strong>data_hdf5</strong> (string): input data HDF5 file. It is an intermediate
   preprocess  version of the input CSV created the first time a CSV
   file is used in the same directory with the same name and a hdf5
   extension</li>
<li><strong>data_train_hdf5</strong> (string): input train data HDF5 file. It is an
   intermediate preprocess  version of the input CSV created the
   first time a CSV file is used in the same directory with the same
   name and a hdf5 extension</li>
<li><strong>data_validation_hdf5</strong> (string): input validation data HDF5 file.
   It is an intermediate preprocess version of the input CSV created
   the first time a CSV file is used in the same directory with the
   same name and a hdf5 extension</li>
<li><strong>data_test_hdf5</strong> (string): input test data HDF5 file. It is an
   intermediate preprocess  version of the input CSV created the
   first time a CSV file is used in the same directory with the same
   name and a hdf5 extension</li>
<li><strong>data_dict</strong> (dict): input data dictionary. It is expected to
   contain one key for each field and the values have to be lists of
   the same length. Each index in the lists corresponds to one
   datapoint. For example a data set consisting of two datapoints
   with a text and a class may be provided as the following dict
   <code>{'text_field_name': ['text of the first datapoint', text of the
   second datapoint'], 'class_filed_name': ['class_datapoints_1',
   'class_datapoints_2']}</code>.</li>
<li><strong>data_train_dict</strong> (dict): input training data dictionary. It is
   expected to contain one key for each field and the values have
   to be lists of the same length. Each index in the lists
   corresponds to one datapoint. For example a data set consisting
   of two datapoints with a text and a class may be provided as the
   following dict:
   <code>{'text_field_name': ['text of the first datapoint', 'text of the
   second datapoint'], 'class_field_name': ['class_datapoint_1',
   'class_datapoint_2']}</code>.</li>
<li><strong>data_validation_dict</strong> (dict): input validation data dictionary. It
   is expected to contain one key for each field and the values have
   to be lists of the same length. Each index in the lists
   corresponds to one datapoint. For example a data set consisting
   of two datapoints with a text and a class may be provided as the
   following dict:
   <code>{'text_field_name': ['text of the first datapoint', 'text of the
   second datapoint'], 'class_field_name': ['class_datapoint_1',
   'class_datapoint_2']}</code>.</li>
<li><strong>data_test_dict</strong> (dict): input test data dictionary. It is
   expected to contain one key for each field and the values have
   to be lists of the same length. Each index in the lists
   corresponds to one datapoint. For example a data set consisting
   of two datapoints with a text and a class may be provided as the
   following dict:
   <code>{'text_field_name': ['text of the first datapoint', 'text of the
   second datapoint'], 'class_field_name': ['class_datapoint_1',
   'class_datapoint_2']}</code>.</li>
<li><strong>train_set_metadata_json</strong> (string): input metadata JSON file. It is an
   intermediate preprocess file containing the mappings of the input
   CSV created the first time a CSV file is used in the same
   directory with the same name and a json extension</li>
<li><strong>experiment_name</strong> (string): a name for the experiment, used for the save
   directory</li>
<li><strong>model_name</strong> (string): a name for the model, used for the save
   directory</li>
<li><strong>model_load_path</strong> (string): path of a pretrained model to load as
   initialization</li>
<li><strong>model_resume_path</strong> (string): path of a the model directory to
   resume training of</li>
<li><strong>skip_save_training_description</strong> (bool, default: <code>False</code>): disables
   saving the description JSON file.</li>
<li><strong>skip_save_training_statistics</strong> (bool, default: <code>False</code>): disables
   saving training statistics JSON file.</li>
<li><strong>skip_save_model</strong> (bool, default: <code>False</code>): disables
   saving model weights and hyperparameters each time the model
   improves. By default Ludwig saves model weights after each epoch
   the validation measure imrpvoes, but if the model is really big
   that can be time consuming if you do not want to keep
   the weights and just find out what performance can a model get
   with a set of hyperparameters, use this parameter to skip it,
   but the model will not be loadable later on.</li>
<li><strong>skip_save_progress</strong> (bool, default: <code>False</code>): disables saving
   progress each epoch. By default Ludwig saves weights and stats
   after each epoch for enabling resuming of training, but if
   the model is really big that can be time consuming and will uses
   twice as much space, use this parameter to skip it, but training
   cannot be resumed later on.</li>
<li><strong>skip_save_log</strong> (bool, default: <code>False</code>): disables saving TensorBoard
   logs. By default Ludwig saves logs for the TensorBoard, but if it
   is not needed turning it off can slightly increase the
   overall speed.</li>
<li><strong>skip_save_processed_input</strong> (bool, default: <code>False</code>): skips saving
   intermediate HDF5 and JSON files</li>
<li><strong>output_directory</strong> (string, default: <code>'results'</code>): directory that
   contains the results</li>
<li><strong>gpus</strong> (string, default: <code>None</code>): list of GPUs to use (it uses the
   same syntax of CUDA_VISIBLE_DEVICES)</li>
<li><strong>gpu_fraction</strong> (float, default <code>1.0</code>): fraction of gpu memory to
   initialize the process with</li>
<li><strong>random_seed</strong> (int, default<code>42</code>): a random seed that is going to be
   used anywhere there is a call to a random number generator: data
   splitting, parameter initialization and training set shuffling</li>
<li><strong>debug</strong> (bool, default: <code>False</code>): enables debugging mode</li>
</ul>
<p>There are three ways to provide data: by dataframes using the <code>_df</code>
parameters, by CSV using the <code>_csv</code> parameters and by HDF5 and JSON,
using <code>_hdf5</code> and <code>_json</code> parameters.
The DataFrame approach uses data previously obtained and put in a
dataframe, the CSV approach loads data from a CSV file, while HDF5 and
JSON load previously preprocessed HDF5 and JSON files (they are saved in
the same directory of the CSV they are obtained from).
For all three approaches either a full dataset can be provided (which
will be split randomly according to the split probabilities defined in
the model definition, by default 70% training, 10% validation and 20%
test) or, if it contanins a plit column, it will be plit according to
that column (interpreting 0 as training, 1 as validation and 2 as test).
Alternatively separated dataframes / CSV / HDF5 files can beprovided
for each split.</p>
<p>During training the model and statistics will be saved in a directory
<code>[output_dir]/[experiment_name]_[model_name]_n</code> where all variables are
resolved to user spiecified ones and <code>n</code> is an increasing number
starting from 0 used to differentiate different runs.</p>
<p><strong>Return</strong></p>
<ul>
<li><strong>return</strong> (dict): a dictionary containing training statistics for each
output feature containing loss and measures values for each epoch.</li>
</ul>
<hr />
<h3 id="train_online">train_online<a class="headerlink" href="#train_online" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">train_online</span><span class="p">(</span>
  <span class="n">data_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">learning_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">regularization_lambda</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">dropout_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">bucketing_field</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">gpu_fraction</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</code></pre></div>


<p>This function is used to perform one epoch of training of the model
on the specified dataset.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>data_df</strong> (DataFrame): dataframe containing data.</li>
<li><strong>data_csv</strong> (string): input data CSV file.</li>
<li><strong>data_dict</strong> (dict): input data dictionary. It is expected to
   contain one key for each field and the values have to be lists of
   the same length. Each index in the lists corresponds to one
   datapoint. For example a data set consisting of two datapoints
   with a text and a class may be provided as the following dict
   <code>`{'text_field_name': ['text of the first datapoint', text of the
   second datapoint'], 'class_filed_name': ['class_datapoints_1',
   'class_datapoints_2']}</code>.</li>
<li><strong>batch_size</strong> (int): the batch size to use for training. By default
   it's the one specified in the model definition.</li>
<li><strong>learning_rate</strong> (float): the learning rate to use for training. By
   default the values is the one specified in the model definition.</li>
<li><strong>regularization_lambda</strong> (float): the regularization lambda
   parameter to use for training. By default the values is the one
   specified in the model definition.</li>
<li><strong>dropout_rate</strong> (float): the dropout rate to use for training. By
   default the values is the one specified in the model definition.</li>
<li><strong>bucketing_field</strong> (string): the bucketing field to use for
   bucketing the data. By default the values is one specified in the
   model definition.</li>
<li><strong>gpus</strong> (string, default: <code>None</code>): list of GPUs to use (it uses the
   same syntax of CUDA_VISIBLE_DEVICES)</li>
<li><strong>gpu_fraction</strong> (float, default <code>1.0</code>): fraction of GPU memory to
   initialize the process with</li>
</ul>
<p>There are three ways to provide data: by dataframes using the <code>data_df</code>
parameter, by CSV using the <code>data_csv</code> parameter and by dictionary,
using the <code>data_dict</code> parameter.</p>
<p>The DataFrame approach uses data previously obtained and put in a
dataframe, the CSV approach loads data from a CSV file, while dict
approach uses data organized by keys representing columns and values
that are lists of the datapoints for each. For example a data set
consisting of two datapoints with a text and a class may be provided as
the following dict <code>`{'text_field_name}: ['text of the first datapoint',
text of the second datapoint'], 'class_filed_name':
['class_datapoints_1', 'class_datapoints_2']}</code>.</p>
<hr />
<h2 id="module-functions">Module functions<a class="headerlink" href="#module-functions" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="kfold_cross_validate">kfold_cross_validate<a class="headerlink" href="#kfold_cross_validate" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="n">ludwig</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">kfold_cross_validate</span><span class="p">(</span>
  <span class="n">k_fold</span><span class="p">,</span>
  <span class="n">model_definition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">model_definition_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">data_csv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
  <span class="n">output_directory</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">,</span>
  <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</code></pre></div>


<p>Performs k-fold cross validation and returns result data structures.</p>
<p><strong>Inputs</strong></p>
<ul>
<li><strong>k_fold</strong> (int): number of folds to create for the cross-validation</li>
<li><strong>model_definition</strong> (dict, default: None): a dictionary containing
   information needed to build a model. Refer to the
   <a href="http://ludwig.ai/user_guide/#model-definition">User Guide</a>
   for details.</li>
<li><strong>model_definition_file</strong> (string, optional, default: <code>None</code>): path to
   a YAML file containing the model definition. If available it will be
   used instead of the model_definition dict.</li>
<li><strong>data_csv</strong> (dataframe, default: None):</li>
<li><strong>data_csv</strong> (string, default: None):</li>
<li><strong>output_directory</strong> (string, default: 'results'):</li>
<li><strong>random_seed</strong> (int): Random seed used k-fold splits.</li>
</ul>
<p><strong>Return</strong></p>
<ul>
    <li><strong>return</strong> (tuple(kfold_cv_stats, kfold_split_indices),
        dict): a tuple of
        dictionaries <code>kfold_cv_stats</code>: contains metrics from cv run.
        <code>kfold_split_indices</code>: indices to split training data into
        training fold and test fold.
    </li>
</ul>


                  </article>
          </div>
        </div>
      </main>
      
        

<!-- Application footer -->
<footer class="md-footer">

    <!-- Link to previous and/or next page -->

    <div class="md-footer-nav">
        <nav aria-label="Footer"
             class="md-footer-nav__inner md-grid">

            <a class="md-footer-nav__link md-footer-nav__link--prev"
               href="../../developer_guide/" rel="prev"
               title="Developer Guide">
                <div class="md-footer-nav__button md-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                    </svg>
                </div>
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Previous
                 </span>
                        Developer Guide
                    </div>
                </div>
            </a>


            <a class="md-footer-nav__link md-footer-nav__link--next"
               href="../visualization/" rel="next"
               title="Visualization">
                <div class="md-footer-nav__title">
                    <div class="md-ellipsis">
                 <span class="md-footer-nav__direction">
                   Next
                 </span>
                        Visualization
                    </div>
                </div>
                <div class="md-footer-nav__button md-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"/>
                    </svg>
                </div>
            </a>
            
        </nav>
    </div>
    

    <!-- Further information -->
    <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">

            <!-- Copyright and theme information -->
            <div class="md-footer-copyright">
                <div class="footer-logo-smallpad"></div>
                
                <div class="md-footer-copyright__highlight">
                    Copyright &copy; 2018 - 2019 Uber Technologies Inc.
                </div>
                
                Website by <a href="http://w4nderlu.st">w4nderlust</a> powered by
                <a href="https://www.mkdocs.org">MkDocs</a>,
                <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a>,
                <a href="http://www.styleshout.com/">styleshout</a> and
                <a href="http://cables.gl/">cables</a>.
            </div>

            <!-- Social links -->


        </div>
    </div>
</footer>

  </div>

  <script src="../../assets/javascripts/vendor.f81b9e8b.min.js"></script>
  <script src="../../assets/javascripts/bundle.23546af0.min.js"></script>
  <script id="__lang" type="application/json">{
      "clipboard.copy": "Copy to clipboard",
      "clipboard.copied": "Copied to clipboard",
      "search.config.lang": "en",
      "search.config.pipeline": "trimmer, stopWordFilter",
      "search.config.separator": "[\\s\\-]+",
      "search.result.placeholder": "Type to start searching",
      "search.result.none": "No matching documents",
      "search.result.one": "1 matching document",
      "search.result.other": "# matching documents"
  }</script>

  <script>
      app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
              worker: "../../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
      })
  </script>


  </body>
</html>